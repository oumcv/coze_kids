<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Coze API Demo</title>
    <script type="module">
        // 1. 导入 SDK
        import { CozeAPI, COZE_CN_BASE_URL, ChatStatus, RoleType } from 'https://cdn.jsdelivr.net/npm/@coze/api@1.3.9/+esm';
        
        // 2. 初始化客户端
        const client = new CozeAPI({
            token: 'pat_50d9UujdAxUtrHezdGy51YAQmId0qhW7NQrxQ0AMccKMwXAw5Bax9u6gQBBP6CGf', // 替换为你的 PAT
            baseURL: COZE_CN_BASE_URL // 国内版使用 COZE_CN_BASE_URL，国际版使用 COZE_COM_BASE_URL
        });
        
        // 3. 核心调用函数
        async function sendMessage() {
            const input = document.getElementById('user-input').value;
            const responseElement = document.getElementById('response');
            
            try {
                const result = await client.chat.createAndPoll({
                    bot_id: '7603669260069666879', // 替换为你的 Bot ID
                    additional_messages: [{
                        role: RoleType.User,
                        content: input,
                        content_type: 'text'
                    }]
                });
                
                if (result.chat.status === ChatStatus.COMPLETED) {
                    const reply = result.messages.find(msg => msg.role === 'assistant').content;
                    responseElement.innerHTML = `<strong>Coze 回复：</strong>${reply}`;
                }
            } catch (error) {
                responseElement.innerHTML = `<strong>错误：</strong>${error.message}`;
            }
        }
        
        // 4. 绑定事件
        document.getElementById('send-btn').addEventListener('click', sendMessage);
    </script>
</head>
<body>
    <h1>Coze API 调用演示</h1>
    <input type="text" id="user-input" placeholder="请输入问题">
    <button id="send-btn">发送</button>
    <div id="response"></div>
</body>
</html>
